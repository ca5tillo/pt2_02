<!DOCTYPE html>
<html lang="es">
<head>
    <title>Visualizador de Java</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">



<style>
svg{
    border: 1px solid #aaa;
}



.node circle{
    fill:white;
    stroke:YellowGreen;
    stroke-width:1.5px;
}
.node{
    font:10px Helvetica;
}
.link{
    fill:none;
    stroke:wheat;
    stroke-width:1.5px;   
}
</style>
<script>

    var variable2 = {
               "node": "CompilationUnit",
               "types": [
                  {
                     "node": "TypeDeclaration",
                     "name": {
                        "identifier": "my",
                        "node": "SimpleName"
                     },
                     "superInterfaceTypes": [],
                     "superclassType": null,
                     "bodyDeclarations": [
                        {
                           "parameters": [],
                           "thrownExceptions": [],
                           "body": {
                              "node": "Block",
                              "statements": []
                           },
                           "extraDimensions": 0,
                           "typeParameters": [],
                           "node": "MethodDeclaration",
                           "returnType2": {
                              "node": "PrimitiveType",
                              "primitiveTypeCode": "void"
                           },
                           "name": {
                              "identifier": "main",
                              "node": "SimpleName"
                           },
                           "constructor": false,
                           "modifiers": [
                              {
                                 "node": "Modifier",
                                 "keyword": "public"
                              },
                              {
                                 "node": "Modifier",
                                 "keyword": "static"
                              }
                           ]
                        },
                        {
                           "parameters": [],
                           "thrownExceptions": [],
                           "body": {
                              "node": "Block",
                              "statements": []
                           },
                           "extraDimensions": 0,
                           "typeParameters": [],
                           "node": "MethodDeclaration",
                           "returnType2": {
                              "node": "PrimitiveType",
                              "primitiveTypeCode": "void"
                           },
                           "name": {
                              "identifier": "test",
                              "node": "SimpleName"
                           },
                           "constructor": false,
                           "modifiers": [
                              {
                                 "node": "Modifier",
                                 "keyword": "public"
                              }
                           ]
                        }
                     ],
                     "typeParameters": [],
                     "interface": false,
                     "modifiers": []
                  }
               ],
               "package": null,
               "imports": []
            } ;


</script>

</head>
<body>


<script src="lib/D3/d3.min.js"></script> 

<style>

.node circle {
  fill: #999;
}

.node text {
  font: 10px sans-serif;
}

.node--internal circle {
  fill: #555;
}

.node--internal text {
  text-shadow: 0 1px 0 #fff, 0 -1px 0 #fff, 1px 0 0 #fff, -1px 0 0 #fff;
}

.link {
  fill: none;
  stroke: #555;
  stroke-opacity: 0.4;
  stroke-width: 1.5px;
}

</style>
<svg width="960" height="2000"></svg>

<script>
	    var variable2 = {
					   "node": "CompilationUnit",
					   "types": [
					      {
					         "node": "TypeDeclaration",
					         "name": {
					            "identifier": "MyClass",
					            "node": "SimpleName"
					         },
					         "superInterfaceTypes": [],
					         "superclassType": null,
					         "bodyDeclarations": [
					            {
					               "parameters": [
					                  {
					                     "node": "SingleVariableDeclaration",
					                     "name": {
					                        "identifier": "args",
					                        "node": "SimpleName"
					                     },
					                     "extraDimensions": 0,
					                     "type": {
					                        "node": "ArrayType",
					                        "componentType": {
					                           "node": "SimpleType",
					                           "name": {
					                              "identifier": "String",
					                              "node": "SimpleName"
					                           }
					                        }
					                     },
					                     "modifiers": [],
					                     "varargs": false,
					                     "initializer": null
					                  }
					               ],
					               "thrownExceptions": [],
					               "body": {
					                  "node": "Block",
					                  "statements": [
					                     {
					                        "node": "VariableDeclarationStatement",
					                        "fragments": [
					                           {
					                              "node": "VariableDeclarationFragment",
					                              "name": {
					                                 "identifier": "a",
					                                 "node": "SimpleName"
					                              },
					                              "extraDimensions": 0,
					                              "initializer": null
					                           }
					                        ],
					                        "modifiers": [],
					                        "type": {
					                           "node": "PrimitiveType",
					                           "primitiveTypeCode": "int"
					                        }
					                     },
					                     {
					                        "node": "VariableDeclarationStatement",
					                        "fragments": [
					                           {
					                              "node": "VariableDeclarationFragment",
					                              "name": {
					                                 "identifier": "c",
					                                 "node": "SimpleName"
					                              },
					                              "extraDimensions": 0,
					                              "initializer": {
					                                 "node": "StringLiteral",
					                                 "escapedValue": "\"Hola mundo \""
					                              }
					                           }
					                        ],
					                        "modifiers": [],
					                        "type": {
					                           "node": "SimpleType",
					                           "name": {
					                              "identifier": "String",
					                              "node": "SimpleName"
					                           }
					                        }
					                     },
					                     {
					                        "node": "VariableDeclarationStatement",
					                        "fragments": [
					                           {
					                              "node": "VariableDeclarationFragment",
					                              "name": {
					                                 "identifier": "i",
					                                 "node": "SimpleName"
					                              },
					                              "extraDimensions": 0,
					                              "initializer": {
					                                 "node": "NumberLiteral",
					                                 "token": "0"
					                              }
					                           },
					                           {
					                              "node": "VariableDeclarationFragment",
					                              "name": {
					                                 "identifier": "b",
					                                 "node": "SimpleName"
					                              },
					                              "extraDimensions": 0,
					                              "initializer": null
					                           }
					                        ],
					                        "modifiers": [],
					                        "type": {
					                           "node": "PrimitiveType",
					                           "primitiveTypeCode": "int"
					                        }
					                     },
					                     {
					                        "node": "WhileStatement",
					                        "expression": {
					                           "node": "InfixExpression",
					                           "operator": "<",
					                           "leftOperand": {
					                              "identifier": "i",
					                              "node": "SimpleName"
					                           },
					                           "rightOperand": {
					                              "node": "NumberLiteral",
					                              "token": "10"
					                           }
					                        },
					                        "body": {
					                           "node": "Block",
					                           "statements": [
					                              {
					                                 "node": "ExpressionStatement",
					                                 "expression": {
					                                    "node": "PostfixExpression",
					                                    "operator": "++",
					                                    "operand": {
					                                       "identifier": "i",
					                                       "node": "SimpleName"
					                                    }
					                                 }
					                              }
					                           ]
					                        }
					                     }
					                  ]
					               },
					               "extraDimensions": 0,
					               "typeParameters": [],
					               "node": "MethodDeclaration",
					               "returnType2": {
					                  "node": "PrimitiveType",
					                  "primitiveTypeCode": "void"
					               },
					               "name": {
					                  "identifier": "main",
					                  "node": "SimpleName"
					               },
					               "constructor": false,
					               "modifiers": [
					                  {
					                     "node": "Modifier",
					                     "keyword": "public"
					                  },
					                  {
					                     "node": "Modifier",
					                     "keyword": "static"
					                  }
					               ]
					            },
					            {
					               "parameters": [
					                  {
					                     "node": "SingleVariableDeclaration",
					                     "name": {
					                        "identifier": "a",
					                        "node": "SimpleName"
					                     },
					                     "extraDimensions": 0,
					                     "type": {
					                        "node": "PrimitiveType",
					                        "primitiveTypeCode": "int"
					                     },
					                     "modifiers": [],
					                     "varargs": false,
					                     "initializer": null
					                  },
					                  {
					                     "node": "SingleVariableDeclaration",
					                     "name": {
					                        "identifier": "b",
					                        "node": "SimpleName"
					                     },
					                     "extraDimensions": 0,
					                     "type": {
					                        "node": "PrimitiveType",
					                        "primitiveTypeCode": "int"
					                     },
					                     "modifiers": [],
					                     "varargs": false,
					                     "initializer": null
					                  }
					               ],
					               "thrownExceptions": [],
					               "extraDimensions": 0,
					               "body": {
					                  "node": "Block",
					                  "statements": [
					                     {
					                        "node": "ReturnStatement",
					                        "expression": {
					                           "node": "InfixExpression",
					                           "operator": "+",
					                           "leftOperand": {
					                              "identifier": "a",
					                              "node": "SimpleName"
					                           },
					                           "rightOperand": {
					                              "identifier": "b",
					                              "node": "SimpleName"
					                           }
					                        }
					                     }
					                  ]
					               },
					               "constructor": false,
					               "node": "MethodDeclaration",
					               "returnType2": {
					                  "node": "PrimitiveType",
					                  "primitiveTypeCode": "int"
					               },
					               "name": {
					                  "identifier": "suma",
					                  "node": "SimpleName"
					               },
					               "typeParameters": [],
					               "modifiers": []
					            }
					         ],
					         "typeParameters": [],
					         "interface": false,
					         "modifiers": [
					            {
					               "node": "Modifier",
					               "keyword": "public"
					            }
					         ]
					      }
					   ],
					   "package": null,
					   "imports": []
					};
	var root = d3.hierarchy(variable2,function(d){
                //console.log(d);
                if (d.node == "CompilationUnit") {
                    return d.types;
                }else if(d.node == "TypeDeclaration"){
                    return d.bodyDeclarations;
                }else if(d.node == "MethodDeclaration"){
                    return d.body.statements;
                }
                return  null ;
            })
        .count();



function graficar() {

var svg = d3.select("svg"),
    width = +svg.attr("width"),
    height = +svg.attr("height"),
    g = svg.append("g").attr("transform", "translate(40,0)");

var tree = d3.cluster()
    .size([height, width - 160]);

var stratify = d3.stratify()
    .parentId(function(d) { return d.id.substring(0, d.id.lastIndexOf(".")); });





  tree(root);

  var link = g.selectAll(".link")
      .data(root.descendants().slice(1))
    .enter().append("path")
      .attr("class", "link")
      .attr("d", function(d) {
        return "M" + d.y + "," + d.x
            + "C" + (d.parent.y + 100) + "," + d.x
            + " " + (d.parent.y + 100) + "," + d.parent.x
            + " " + d.parent.y + "," + d.parent.x;
      });

  var node = g.selectAll(".node")
      .data(root.descendants())
    .enter().append("g")
      .attr("class", function(d) { return "node" + (d.children ? " node--internal" : " node--leaf"); })
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; })

  node.append("circle")
      .attr("r", 2.5);

  node.append("text")
      .attr("dy", 3)
      .attr("x", function(d) { return d.children ? -8 : 8; })
      .style("text-anchor", function(d) { return d.children ? "end" : "start"; })
      .text(function(d) { return d.id.substring(d.id.lastIndexOf(".") + 1); });



}
graficar();
</script>

</body>
</html>